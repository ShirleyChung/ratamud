# NPC èªªè©±åŠŸèƒ½å¯¦ç¾ç¸½çµ

## ğŸ“‹ å¯¦ç¾å…§å®¹

### 1. æ–°å¢è³‡æ–™çµæ§‹ï¼ˆperson.rsï¼‰
- **dialogues**: `HashMap<String, String>` - å­˜å„²å ´æ™¯èˆ‡å°è©çš„å°æ‡‰é—œä¿‚
- **talk_eagerness**: `u8` (0-100) - èªªè©±ç©æ¥µåº¦ï¼Œé è¨­å€¼ 100

### 2. æ–°å¢æ–¹æ³•ï¼ˆperson.rsï¼‰
- `set_dialogue()` - è¨­ç½®ç‰¹å®šå ´æ™¯çš„å°è©
- `set_talk_eagerness()` - è¨­ç½®èªªè©±ç©æ¥µåº¦
- `get_dialogue()` - ç²å–ç‰¹å®šå ´æ™¯çš„å°è©
- `try_talk()` - æ ¹æ“šç©æ¥µåº¦éš¨æ©Ÿæ±ºå®šæ˜¯å¦èªªè©±

### 3. æ–°å¢å‘½ä»¤ï¼ˆinput.rsï¼‰
- **setdialogue / setdia** - è¨­ç½® NPC å°è©
  - èªæ³•ï¼š`setdialogue <npc> <å ´æ™¯> <å°è©>`
  - ç¯„ä¾‹ï¼š`setdialogue å•†äºº è¦‹é¢ å“ˆå›‰ï¼æ­¡è¿å…‰è‡¨ï¼`

- **seteagerness / setea** - è¨­ç½® NPC èªªè©±ç©æ¥µåº¦
  - èªæ³•ï¼š`seteagerness <npc> <ç©æ¥µåº¦0-100>`
  - ç¯„ä¾‹ï¼š`seteagerness å•†äºº 100`

### 4. æ–°å¢è™•ç†å‡½æ•¸ï¼ˆapp.rsï¼‰
- `handle_set_dialogue()` - è™•ç†è¨­ç½®å°è©çš„é‚è¼¯
- `handle_set_eagerness()` - è™•ç†è¨­ç½®ç©æ¥µåº¦çš„é‚è¼¯

### 5. ä¿®æ”¹ look é¡¯ç¤ºé‚è¼¯ï¼ˆapp.rsï¼‰
åœ¨ `display_look()` å‡½æ•¸ä¸­ï¼Œç•¶é¡¯ç¤ºç•¶å‰ä½ç½®çš„ NPC æ™‚ï¼š
- è‡ªå‹•èª¿ç”¨ `npc.try_talk("è¦‹é¢")`
- å¦‚æœè¿”å›å°è©ï¼Œå‰‡é¡¯ç¤º `ğŸ’¬ {npcåç¨±} èªªï¼šã€Œ{å°è©}ã€`

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

1. **éš¨æ©Ÿæ©Ÿåˆ¶**
   - ä½¿ç”¨ `rand::thread_rng()` ç”Ÿæˆ 0-99 çš„éš¨æ©Ÿæ•¸
   - å¦‚æœéš¨æ©Ÿæ•¸ < ç©æ¥µåº¦ï¼Œå‰‡è§¸ç™¼èªªè©±
   - ç©æ¥µåº¦ 100 = ä¸€å®šèªªè©±ï¼Œç©æ¥µåº¦ 0 = æ°¸ä¸èªªè©±

2. **æ•¸æ“šæŒä¹…åŒ–**
   - å°è©å’Œç©æ¥µåº¦è‡ªå‹•åºåˆ—åŒ–åˆ° NPC çš„ JSON æ–‡ä»¶
   - ä½¿ç”¨ `#[serde(default)]` ç¢ºä¿å‘å¾Œå…¼å®¹

3. **å ´æ™¯ç³»çµ±**
   - ç›®å‰æ”¯æ´ã€Œè¦‹é¢ã€å ´æ™¯
   - å¯è¼•é¬†æ“´å±•å…¶ä»–å ´æ™¯ï¼ˆå‘Šåˆ¥ã€äº¤æ˜“ã€æˆ°é¬¥ç­‰ï¼‰

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. **src/person.rs**
   - æ·»åŠ  dialogues å’Œ talk_eagerness å­—æ®µ
   - æ·»åŠ ç›¸é—œæ–¹æ³•
   - æ·»åŠ é è¨­å€¼å‡½æ•¸

2. **src/input.rs**
   - æ·»åŠ æ–°å‘½ä»¤åˆ° handle_command()
   - æ·»åŠ æ–°çš„ CommandResult è®Šé«”

3. **src/app.rs**
   - æ·»åŠ å‘½ä»¤è™•ç†å‡½æ•¸
   - ä¿®æ”¹ display_look() ä»¥è§¸ç™¼ NPC èªªè©±
   - æ·»åŠ å‘½ä»¤è·¯ç”±

4. **Cargo.toml**
   - ç„¡éœ€ä¿®æ”¹ï¼ˆrand ä¾è³´å·²å­˜åœ¨ï¼‰

## ğŸ§ª æ¸¬è©¦

### æ¸¬è©¦æ–‡ä»¶
- `test_npc_talk.sh` - è‡ªå‹•åŒ–æ¸¬è©¦è…³æœ¬
- `demo_npc_talk.sh` - äº’å‹•å¼æ¼”ç¤ºè…³æœ¬

### æ–‡æª”
- `Docs/NPC_TALK_QUICKSTART.md` - å¿«é€Ÿé–‹å§‹æŒ‡å—
- `Docs/NPC_TALK_FEATURE.md` - è©³ç´°æŠ€è¡“æ–‡æª”

## âœ… ç·¨è­¯ç‹€æ…‹

```bash
$ cargo build --release
   Compiling ratatui_demo v0.1.0
   Finished `release` profile [optimized] target(s) in 4.22s
```

åªæœ‰ä¸€å€‹ç„¡å®³çš„è­¦å‘Šï¼ˆæœªä½¿ç”¨çš„ get_dialogue æ–¹æ³•ï¼‰

## ğŸ® ä½¿ç”¨ç¤ºä¾‹

```bash
# å•Ÿå‹•éŠæˆ²
cargo run --release --bin main

# å‰µå»ºå•†äºº
create npc m å¼µå•†äºº

# è¨­ç½®å°è©å’Œç©æ¥µåº¦
setdialogue å¼µå•†äºº è¦‹é¢ å“ˆå›‰ï¼ä½ å¥½ï¼Œä¾†çœ‹çœ‹æˆ‘çš„å•†å“å§ï¼
seteagerness å¼µå•†äºº 100

# ç§»å‹•æ¸¬è©¦
goto 52 52
goto 50 50
goto 52 52
```

## ğŸš€ æœªä¾†æ“´å±•æ–¹å‘

1. **æ›´å¤šå ´æ™¯**
   - å‘Šåˆ¥å ´æ™¯ï¼ˆç©å®¶é›¢é–‹æ™‚ï¼‰
   - äº¤æ˜“å ´æ™¯ï¼ˆé€²è¡Œäº¤æ˜“æ™‚ï¼‰
   - æˆ°é¬¥å ´æ™¯ï¼ˆæˆ°é¬¥æ™‚ï¼‰
   - é–’èŠå ´æ™¯ï¼ˆéš¨æ©Ÿè§¸ç™¼ï¼‰

2. **æ¢ä»¶å°è©±**
   - æ ¹æ“šæ™‚é–“èªªä¸åŒçš„è©±
   - æ ¹æ“šç©å®¶æŒæœ‰ç‰©å“
   - æ ¹æ“šé—œä¿‚å¥½æ„Ÿåº¦

3. **å°è©±æ¨¹**
   - å¤šè¼ªå°è©±ç³»çµ±
   - åˆ†æ”¯é¸æ“‡
   - ä»»å‹™è§¸ç™¼

4. **èªéŸ³æ•ˆæœ**
   - æ–‡å­—æ•ˆæœï¼ˆé¡è‰²ã€å‹•ç•«ï¼‰
   - æ‰“å­—æ©Ÿæ•ˆæœæ•´åˆ

## ğŸ“Š ä»£ç¢¼çµ±è¨ˆ

- æ–°å¢ä»£ç¢¼è¡Œæ•¸ï¼šç´„ 150 è¡Œ
- ä¿®æ”¹æ–‡ä»¶æ•¸ï¼š3 å€‹æ ¸å¿ƒæ–‡ä»¶
- æ–°å¢æ–‡æª”ï¼š3 å€‹
- æ–°å¢æ¸¬è©¦è…³æœ¬ï¼š2 å€‹
